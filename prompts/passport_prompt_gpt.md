## Задача

Тебе дано изображение. Это может быть:

* обычный российский паспорт (внутренний паспорт),
* загранпаспорт,
* или вообще любое другое изображение (не паспорт).

Твоя задача:

1. Определить тип документа: обычный российский паспорт (`"passport"`) или загранпаспорт (`"foreign"`).
2. Извлечь требуемые поля (см. схемы ниже) и вернуть один JSON-объект.
3. Нормализовать значения (формат дат, пробелы и т.д.). Если поле не найдено — вернуть пустую строку `""`.
4. Если изображение не паспорт — вернуть только поле `"error"` (пример ниже).

---

## Общие правила вывода

* Все даты выводи в формате `DD.MM.YYYY` (ISO). Если преобразование невозможно — оставь строку как на изображении.
* Строки — без начальных/конечных пробелов. Убери лишние переносы.
* Если поле не найдено — присвой пустую строку `""`.
* Если изображение не паспорт — верни JSON вида:

```json
{"error": "На изображении не обнаружен паспорт (короткое описание проблемы на русском)"}
```

---

## Схема — обычный российский паспорт (internal passport)

```json
{
    "passport_type": "passport",
    "passport_surname": "value",
    "passport_name": "value",
    "passport_patronymic": "value",
    "passport_sex": "М или Ж",
    "passport_birth_date": "DD.MM.YYYY",
    "passport_birth_place": "value",
    "passport_series": "####",
    "passport_number": "######",
    "passport_issue_date": "DD.MM.YYYY",
    "passport_department_code": "XXX-XXX",
    "passport_issued_by": "value",
    "passport_citizenship": "value",
    "passport_mrz": "value"
}
```

### Краткие и простые проверки для внутренних паспортов

* `passport_surname`, `passport_name`, `passport_patronymic`: брать как написано в документе (обычно кириллица). Если отчества нет — `""`.
* `passport_sex`: вернуть `"М"` или `"Ж"` (кириллица). Если на документе латинские `M/F` — преобразовать (M→М, F→Ж).
* `passport_birth_date`: искать привычные форматы `DD.MM.YYYY`, `DD.MM.YY`, `DD.MM.YYYY` и конвертировать в `DD.MM.YYYY`. Если не удаётся — оставить как на изображении.
* `passport_birth_place`: почти всегда будет тем же самым городом, где выдали паспорт
* `passport_series`: ожидать ровно 4 цифры. На изображении часто через пробел (например `26 74`) — записать слитно `2674`. Если распознано не 4 цифры — вернуть то, что распознано.
* `passport_number`: ОБЯЗАТЕЛЬНО должно быть 6 цифр! Иначе быть не может! На изображении есть два места, где находится этот номер - на верхней странице паспорта и на нижней - так вот эти цифры номера на них одинаковы. Посмотри там, где понятней. И запомни - ОБЯЗАТЕЛЬНО 6 ЦИФР! Например "356423", "642412", "742685", "952474" и т.д. Чтобы точно не запутаться, напиши в ответ их через тире, вот так: "53-64-13", "64-42-63", "23-64-23" - тут сразу понятно, что 6 цифр.
* Серия и номер обычно дублируются (верх/низ страницы) — если обе копии распознаны и совпадают — вернуть их; если не совпадают — вернуть вариант, который встречается чаще или выглядит более разборчиво.
* `passport_issue_date`: конвертировать в `DD.MM.YYYY` как и другие даты. Не выполнять строгой проверки возраста — просто вернуть распознанное.
* `passport_department_code`: если найдено 6 цифр без дефиса — вернуть в формате `XXX-XXX`. Если длина иная — вернуть как распознано.
* `passport_issued_by`: обычно выглядит как "УМВД", или "УФМС", или "ОВД", или "МФЦ" и т.д по чему-то там, вероятнее всего по тому же городу, в котором проживает гражданин. Например, если он проживает в московской области, то будет вероятнее всего "по московской области" и т.д.
`passport_citizenship`: сохранять как есть.

---

## Схема — загранпаспорт (упрощённо)

```json
{
    "passport_type": "foreign",
    "foreign_doc_type": "value",
    "foreign_country_code": "XXX",
    "foreign_citizenship": "value",
    "foreign_latin_name": "value",
    "foreign_birth_date": "YYYY-MM-DD",
    "foreign_sex": "value",
    "foreign_birth_place": "value",
    "foreign_number": "XXXXXXX",
    "foreign_issue_date": "YYYY-MM-DD",
    "foreign_expiry_date": "YYYY-MM-DD",
    "foreign_issued_by": "value",
    "foreign_mrz": "value"
}
```

### Краткие и простые проверки для загранпаспортов

* `foreign_doc_type`: брать как есть (обычно `P`).
* `foreign_country_code`: если в документе три буквы — сохранить три; если две — сохранить две.
* `foreign_latin_name`: сохранить латиницу как в документе; если имя на нескольких частях — склеить пробелом.
* `foreign_birth_date`, `foreign_issue_date`, `foreign_expiry_date`: конвертировать в `DD.MM.YYYY` при возможности. Если распознано обе даты `issue` и `expiry`, и видно, что expiry < issue — вернуть оба как распознаны (без дополнительных проверок).
* `foreign_sex`: вернуть `M`/`F` или русские `М`/`Ж` — можно нормализовать к одному стилю по выбору.
* `foreign_number`: вернуть как на документе.
* `foreign_issued_by`: сохранить как есть.

---

## Дополнительные простые кросс-проверки

* Если серия+номер встречаются дважды — предпочесть совпадающие значения; если оба места распознаны, но не совпадают — вернуть более разборчивый вариант.
* Для дат — попытка нормализации в `DD.MM.YYYY`, без дополнительных логических проверок.
* Проверять строгие правила (MRZ, контрольные суммы, возрастные правила) **не нужно** в этой версии.

---

## Поведение при ошибках и нештатных случаях

* Если на изображении **не паспорт** (книга, удостоверение, фото и т.п.) — вернуть только:

```json
{"error": "На изображении не обнаружен паспорт или документ плохо читаем (короткая причина на русском)"}
```

* В остальных случаях вернуть JSON со всеми полями (пустые строки для нераспознанных полей).

---